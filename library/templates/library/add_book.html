{% extends 'base.html' %}
<head>
    <meta charset="UTF-8">
    {% block extrahead %}
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    {{ form.media.css }}
    {% endblock %}
</head>

<body>
    {% block content %}
    <script type="text/javascript" src="/static/js/jquery.js"></script>
    {{ form.media.js }}

    <script>
        $(document).ready(function() {
            $('.django-select2').select2({
                tags: true,
                tokenSeparators: [',']
            });
        });
    </script>
    <script>

        function get_selected() {
            let form = document.getElementsByName('my-form')[0];
            let articles = form.getElementsByClassName('select2-selection__choice__display');

            for( let i = 0; i < articles.length; i++){
                if (document.getElementById("tags_requested") !== null) {
                    let element = document.getElementById("tags_requested");
                    element.remove();
                }
                var text = [text, articles[i].innerText].join(';');
              }
              var x = document.createElement("input");
                x.setAttribute("type", "hidden");
                x.setAttribute("name", "tags");
                x.setAttribute("value", text);
                x.setAttribute("id", "tags_requested");
                document.getElementById("own_form").appendChild(x);
        }
    </script>
      <div class="container py-5">
        <h1>Заполните поля</h1>
        <form method="POST" name="my-form" id="own_form" class="post-form" enctype="multipart/form-data">{% csrf_token %}
            {{ formAuthor.as_p }}
            {{ formBook.as_p }}
            {{ formBookTag.as_p }}
            {{ formCopy.as_p }}
            {{ formStorage.as_p }}
            <button type="submit" class="btn btn-primary profile-button">Сохранить</button>
        </form>
      </div>
    {% endblock %}
</body>